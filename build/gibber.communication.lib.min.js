!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Gibber=e()}}(function(){var define,module,exports;return function e(t,o,n){function r(a,u){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var p=o[a]={exports:{}};t[a][0].call(p.exports,function(e){var o=t[a][1][e];return r(o?o:e)},p,p.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t){(function(e){!function(){"use strict";function o(e,t,n){for(var r in t)n&&(l(t[r])||c(t[r]))?(l(t[r])&&!l(e[r])&&(e[r]={}),c(t[r])&&!c(e[r])&&(e[r]=[]),o(e[r],t[r],n)):void 0!==t[r]&&(e[r]=t[r])}var n="function"==typeof Zepto,r="function"==typeof jQuery,i="object"==typeof e.$||"function"==typeof e.$,a=null,u=n||r||i,c=Array.isArray,p=function(e){return"object"==typeof e},l=function(e){return p(e)&&Object.getPrototypeOf(e)==Object.prototype};a=u?r?jQuery:n?Zepto:i?e.$:{}:{},u||(a.extend=function(e){var t,n=Array.prototype.slice.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){o(e,n,t)}),e},a.isArray=Array.isArray,a.isPlainObject=l,a.type=function(e){return typeof e});var s={};a.subscribe=function(e,t){"undefined"==typeof s[e]&&(s[e]=[]),s[e].push(t)},a.unsubscribe=function(e,t){if("undefined"!=typeof s[e]){var o=s[e];o.splice(o.indexOf(t),1)}},a.publish=function(e,t){if("undefined"!=typeof s[e])for(var o=s[e],n=0;n<o.length;n++)o[n](t)},t.exports=a}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(_dereq_,module,exports){!function(){var $=_dereq_("./dollar"),Gibber={dollar:$,Presets:{},GraphicsLib:{},Binops:{},scale:null,minNoteFrequency:50,started:!1,outputCurves:{LINEAR:0,LOGARITHMIC:1},"export":function(e){Gibber.Utilities.export(e),Gibber.Audio&&Gibber.Audio.export(e),Gibber.Graphics&&Gibber.Graphics.export(e),Gibber.Interface&&Gibber.Interface.export(e)},init:function(e){"undefined"==typeof window?(window=GLOBAL,document=GLOBAL.document=!1):"undefined"!=typeof GLOBAL&&(GLOBAL.document||(document=GLOBAL.document=!1));var t={globalize:!0,canvas:null,target:window,graphicsMode:"3d"};"object"==typeof e&&$.extend(t,e),Gibber.Audio&&(Gibber.Audio.init(),t.globalize?t.target.Master=Gibber.Audio.Master:$.extend(Gibber,Gibber.Audio)),Gibber.Graphics,Gibber.Interface,t.globalize&&Gibber.export(t.target),t.target.$=$,Gibber.Utilities.init()},Modules:{},"import":function(e,t){var o=null;if(console.log("Loading module "+e+"..."),-1===e.indexOf("http:"))console.log("loading via post",e),$.post(Gibber.Environment.SERVER_URL+"/gibber/"+e,{},function(n){n=JSON.parse(n);var r=new Function("return "+n.text);return Gibber.Modules[e]=r(),t&&Gibber.Modules[e]&&$.extend(t,Gibber.Modules[e]),Gibber.Modules[e]?("function"==typeof Gibber.Modules[e].init&&Gibber.Modules[e].init(),console.log("Module "+e+" is now loaded.")):console.log("Publication "+e+" is loaded. It may not be a valid module."),null!==o&&o(Gibber.Modules[e]),!1});else{var n=document.createElement("script");n.src=e,n.onload=function(){console.log("Module "+e+" is now loaded."),null!==o&&o()},document.head.appendChild(n)}return{done:function(e){o=e}}},scriptCallbacks:[],run:function(script,pos,cm){var _start=pos.start?pos.start.line:pos.line,tree;try{tree=Gibber.Esprima.parse(script,{loc:!0,range:!0})}catch(e){return console.error("Parse error on line "+(_start+e.lineNumber)+" : "+e.message.split(":")[1]),void 0}for(var __i__=0;__i__<tree.body.length;__i__++){var obj=tree.body[__i__],start={line:_start+obj.loc.start.line-1,ch:obj.loc.start.column},end={line:_start+obj.loc.end.line-1,ch:obj.loc.end.column},src=cm.getRange(start,end),result=null;try{result=eval(src),"function"!=typeof result?log(result):log("Function")}catch(e){console.error("Error evaluating expression beginning on line "+(start.line+1)+"\n"+e.message)}if(this.scriptCallbacks.length>0)for(var ___i___=0;___i___<this.scriptCallbacks.length;___i___++)this.scriptCallbacks[___i___](obj,cm,pos,start,end,src,_start)}},processArguments:function(e,t){var o;return e.length?"string"==typeof e[0]&&"Drums"!==t&&"XOX"!==t?(o=Gibber.getPreset(e[0],t),"object"==typeof e[1]&&$.extend(o,e[1]),o):Array.prototype.slice.call(e,0):o},processArguments2:function(e,t,o){if(t.length){var n=t[0];if("string"==typeof n&&"Drums"!==o&&"XOX"!==o&&"Shader"!==o)preset=Gibber.getPreset(t[0],o),"object"==typeof t[1]&&$.extend(preset,t[1]),$.extend(e,preset),e.presetInit&&e.presetInit();else if($.isPlainObject(n)&&"undefined"==typeof n.type)$.extend(e,n);else{var r=Object.keys(e.properties);if("FX"===e.type)for(var i=0;i<t.length;i++)e[r[i+1]]=t[i];else for(var i=0;i<t.length;i++)e[r[i]]=t[i]}}},getPreset:function(e,t){var o={};return Gibber.Presets[t]?Gibber.Presets[t][e]?o=Gibber.Presets[t][e]:Gibber.log(t+" does not have a preset named "+e+"."):Gibber.log(t+" does not have a preset named "+e+"."),o},clear:function(){Gibber.Audio&&Gibber.Audio.clear(),Gibber.Graphics&&Gibber.Graphics.clear(),Gibber.proxy(window),$.publish("/gibber/clear",{}),console.log("Gibber has been cleared.")},proxy:function(e){for(var t="abcdefghijklmnopqrstuvwxyz",o=0;o<t.length;o++){var n=t.charAt(o);"undefined"!=typeof window[n]&&(delete window[n],delete window["___"+n]),function(){var t=n;Object.defineProperty(e,t,{configurable:!0,get:function(){return e["___"+t]},set:function(o){if(o)e["___"+t]&&"function"==typeof e["___"+t].replaceWith&&(e["___"+t].replaceWith(o),console.log(e["___"+t].name+" was replaced with "+o.name)),e["___"+t]=o;else if(e["___"+t]){var n=e["___"+t];n&&"function"==typeof n.kill&&n.kill()}}})}()}},construct:function(e,t){function o(){return e.apply(this,t)}return o.prototype=e.prototype,new o},createMappingObject:function(e,t){var o="function"==typeof e.min?e.min():e.min,n="function"==typeof e.max?e.max():e.max,r="function"==typeof t.min?t.min():t.min,i="function"==typeof t.max?t.max():t.max;if("undefined"==typeof t.object&&t.Value&&(t=t.Value),"undefined"!=typeof e.object[e.Name].mapping)return e.object[e.Name].mapping.replace(t.object,t.name,t.Name),void 0;"undefined"!=typeof t.targets&&-1===t.targets.indexOf(e)&&t.targets.push([e,e.Name]);var a="Out"!==t.Name?t.timescale:"audioOut";return mapping=Gibber.mappings[e.timescale][a](e,t),Object.defineProperties(e.object[e.Name],{min:{configurable:!0,get:function(){return o},set:function(t){o=t,e.object[e.Name].mapping.outputMin=o}},max:{configurable:!0,get:function(){return n},set:function(t){n=t,e.object[e.Name].mapping.outputMax=n}}}),e.object[e.Name].mappingObjects=[],Gibber.createProxyProperty(e.object[e.Name],"min",1,0,{min:o,max:n,output:e.output,timescale:e.timescale,dimensions:1}),Gibber.createProxyProperty(e.object[e.Name],"max",1,0,{min:o,max:n,output:e.output,timescale:e.timescale,dimensions:1}),Object.defineProperties(t.object[t.Name],{min:{configurable:!0,get:function(){return r},set:function(t){r=t,e.object[e.Name].mapping.inputMin=r}},max:{configurable:!0,get:function(){return i},set:function(t){i=t,e.object[e.Name].mapping.inputMax=i}}}),e.object[e.Name].invert=function(){e.object[e.Name].mapping.invert()},"undefined"==typeof e.object.mappings&&(e.object.mappings=[]),e.object.mappings.push(mapping),"undefined"==typeof t.object.mappings&&(t.object.mappings=[]),t.object.mappings.push(mapping),Gibber.defineSequencedProperty(e.object[e.Name],"invert"),mapping},defineSequencedProperty:function(e,t,o){var n,r,i=e[t];!e.seq&&Gibber.Audio&&(e.seq=Gibber.Audio.Seqs.Seq({doNotStart:!0,scale:e.scale,priority:o,target:e})),i.seq=function(a,u){var c={key:t,values:$.isArray(a)||null!==a&&"function"!=typeof a&&"number"==typeof a.length?a:[a],durations:$.isArray(u)?u:"undefined"!=typeof u?[u]:null,target:e,priority:o};return"undefined"!=typeof n&&(n.shouldStop=!0,e.seq.seqs.splice(r,1)),e.seq.add(c),r=e.seq.seqs.length-1,n=e.seq.seqs[r],null===c.durations&&e.seq.autofire.push(n),Object.defineProperties(i.seq,{values:{configurable:!0,get:function(){return e.seq.seqs[r].values},set:function(o){Array.isArray(o)||(o=[o]),"note"===t&&e.seq.scale&&(o=makeNoteFunction(o,e.seq)),e.seq.seqs[r].values=o}},durations:{configurable:!0,get:function(){return e.seq.seqs[r].durations},set:function(t){Array.isArray(t)||(t=[t]),e.seq.seqs[r].durations=t}}}),e.seq.isRunning||(e.seq.offset=Gibber.Clock.time(e.offset),e.seq.start(!0,o)),e},i.seq.stop=function(){n.shouldStop=!0},i.seq.start=function(){n.shouldStop=!1,e.seq.timeline[0]=[n],e.seq.nextTime=0,e.seq.isRunning||e.seq.start(!1,o)}},defineRampedProperty:function(e,t){var o,n=e[t],r=t.slice(1);n.ramp=function(t,n,i){return arguments.length<2?(console.err("ramp requires at least two arguments: target and time."),void 0):("undefined"==typeof i&&(i=n,n=t,t=e[r]()),o&&o(),"object"!=typeof t?e[r]=Line(t,n,i):t.retrigger(n,Gibber.Clock.time(i)),o=future(function(){e[r]=n},i),e)}},createProxyMethods:function(e,t){for(var o=0;o<t.length;o++)Gibber.defineSequencedProperty(e,t[o])},defineProperty:function(e,t,o,n,r,i,a){var u="object"==typeof e[t]?e[t].valueOf():e[t],c=t.charAt(0).toUpperCase()+t.slice(1),p=function(o){var n=p;return o&&(e[t]=o,n=e),n};r=i?r||e.mappingProperties[t]:null,$.extend(p,r),$.extend(p,{propertyName:t,Name:c,value:u,type:"property",object:e,targets:[],valueOf:function(){return p.value},toString:function(){return p.value.toString()},oldSetter:e.__lookupSetter__(t),oldGetter:e.__lookupGetter__(t),oldMappingObjectGetter:e.__lookupGetter__(c),oldMappingObjectSetter:e.__lookupSetter__(c)}),Object.defineProperty(e,t,{configurable:!0,get:function(){return p},set:function(t){if("function"!=typeof t&&("object"!=typeof t||"mapping"!==t.type)||"property"!==t.type&&"mapping"!==t.type){i&&e[p.Name]&&"undefined"!=typeof e[p.Name].mapping&&e[p.Name].mapping.remove&&e[p.Name].mapping.remove(!0);var o=t;if(p.oldSetter){var n=p.oldSetter.call(e,t);"undefined"!=typeof n&&(o=n)}p.value=o}else Gibber.createMappingObject(p,t);return e}}),o&&Gibber.defineSequencedProperty(e,t,a),n&&Gibber.defineRampedProperty(e,t),i&&Object.defineProperty(e,p.Name,{configurable:!0,get:function(){return"function"==typeof p.oldMappingObjectGetter&&p.oldMappingObjectGetter(),p},set:function(t){e[p.Name]=t,"function"==typeof mapping.oldMappingObjectSetter&&mapping.oldMappingObjectSetter(t)}})},createProxyProperty:function(e,t,o,n,r,i,a){i=i===!1?!1:!0,Gibber.defineProperty(e,t,o,n,r,i,a)},createProxyProperties:function(e,t,o,n){var r="undefined"==typeof o?!0:o,i="undefined"==typeof n?!0:n;e.gibber=!0,e.mappingProperties=t,e.mappingObjects=[];for(var a in t)t[a].doNotProxy||Gibber.createProxyProperty(e,a,r,i,t[a])}};Gibber.Utilities=_dereq_("./utilities")(Gibber),Gibber.mappings=_dereq_("./mappings")(Gibber),module.exports=Gibber}()},{"./dollar":1,"./mappings":3,"./utilities":4}],3:[function(e,t){t.exports=function(e){var t={audio:{graphics:function(t,o){"undefined"==typeof o.object.track&&(o.object.track={});var n,r="undefined"!=typeof o.object.track[o.propertyName]?o.object.track[o.propertyName]:new e.Audio.Core.Proxy2(o.object,o.propertyName),i=new e.Audio.Core.OnePole({a0:.005,b1:.995});return o.object.track=r,n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(r,t.min,t.max,o.min,o.max,t.output,o.wrap),i.input=n,t.object[t.propertyName]=i,n.proxy=r,n.op=i,n.remove=function(e){e||(t.object[t.propertyName]=t.object[t.Name].mapping.getValue()),delete t.object[t.Name].mapping},n},"interface":function(t,o){var n,r="undefined"!=typeof o.track?o.track:new e.Audio.Core.Proxy2(o.object,o.name),i=new e.Audio.Core.OnePole({a0:.005,b1:.995}),a=t.max-t.min,u=(t.object[t.propertyName]-t.min)/a,c=o.min+(o.max-o.min)*u;if(o.object.setValue&&o.object.setValue(c),o.track=r,n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(r,t.min,t.max,o.min,o.max,t.output,o.wrap),i.input=n,t.object[t.propertyName]=i,n.proxy=r,n.op=i,n.remove=function(e){e||(t.object[t.propertyName]=n.getValue()),delete n},"undefined"!=typeof o.object.label){for(var p="",l=0;l<o.targets.length;l++){var s=o.targets[l];p+=s[0].object.name+"."+s[1],l!==o.targets.length-1&&(p+=" & ")}o.object.label=p}return n.replace=function(e,o,n){r.setInput(e),-1===e[n].targets.indexOf(t)&&e[n].targets.push([t,t.Name])},n},audio:function(t,o){var n,r;return"undefined"!=typeof o.object.track?(n=o.object.track,n.count++):(n=new e.Audio.Core.Proxy2(o.object,o.propertyName),n.count=1),o.object.track=n,t.object[t.propertyName]=e.Audio.Core.Binops.Map(n,t.min,t.max,o.min,o.max),r=t.object[t.Name].mapping=t.object[t.propertyName],r.remove=function(e){e||(t.object[t.propertyName]=r.getValue()),r.op&&r.op.remove(),delete t.object[t.Name].mapping},r.replace=function(o,n,i){var a=new e.Audio.Core.Proxy2(o,n);r.input=a,o[i].targets&&-1===o[i].targets.indexOf(t)&&o[i].targets.push([t,t.Name])},r},audioOut:function(t,o){var n;n=e.Audio.Core.Binops.Map(null,t.min,t.max,0,1,0),t.object[t.propertyName]=t.object[t.Name].mapping=n,"undefined"!=typeof o.object.track?(n.follow=o.object.track,n.follow.count++):(n.follow=new e.Audio.Analysis.Follow({input:o.object,useAbsoluteValue:!0}),n.follow.count=1),o.object.track=n.input=n.follow,n.remove=function(e){e||(t.object[t.propertyName]=t.object[t.Name].mapping.getValue()),n.bus&&n.bus.disconnect(),n.follow&&(n.follow.count--,0===n.follow.count&&(delete o.object.track,n.follow.remove())),delete t.object[t.Name].mapping},n.replace=function(e,o,r){n.follow.input=e,-1===e[r].targets.indexOf(t)&&e[r].targets.push([t,t.Name])};var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{configurable:!0,get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),n}},graphics:{graphics:function(t,o){var n,r=e.Audio.Core.Binops.Map(o.object[o.propertyName],t.min,t.max,o.min,o.max,t.output,o.wrap),i=r.getValue.bind(r);return r.getValue=function(){return r.callback(o.object[o.propertyName],t.min,t.max,o.min,o.max,t.output,o.wrap),i()},n=t.object[t.Name].mapping=r,t.object.mod?t.object.mod(t.propertyName,n,"="):t.modObject.mod(t.modName,n,"="),n.remove=function(){t.object.mod?t.object.removeMod(t.propertyName):t.modObject.removeMod(t.modName),t.object[t.propertyName]=t.object[t.Name].mapping.getValue(),delete t.object[t.Name].mapping},n.replace=function(e){n.input=e},n},"interface":function(t,o){var n,r=e.Audio.Core.Binops.Map(o.object[o.name],t.min,t.max,o.min,o.max,t.output,o.wrap);"undefined"==typeof o.object.functions&&(o.object.functions={},o.object.onvaluechange=function(){for(var e in o.object.functions)o.object.functions[e]()}),n=t.object[t.Name].mapping=r,t.mapping.from=o;var i=t.propertyName+" <- "+o.object.propertyName+"."+o.Name;if(o.object.functions[i]=function(){var e=n.callback(o.object[o.name],t.min,t.max,o.min,o.max,t.output,o.wrap);t.object[t.Name].oldSetter.call(t.object[t.Name],e)},n.replace=function(){},n.remove=function(){console.log("mapping removed"),delete o.object.functions[i]},o.object.setValue&&o.object.setValue(t.object[t.propertyName]),"undefined"!=typeof o.object.label){for(var a="",u=0;u<o.targets.length;u++){var c=o.targets[u];a+=c[0].object.propertyName+"."+c[1],u!==o.targets.length-1&&(a+=" & ")}o.object.label=a}return n},audio:function(t,o){var n;n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(null,t.min,t.max,o.min,o.max,t.output,o.wrap),n.follow="undefined"!=typeof o.object.track?o.object.track:new e.Audio.Core.Follow({input:o.object[o.propertyName],useAbsoluteValue:!1}),o.object.track=t.object[t.Name].mapping.follow,n.input=n.follow,n.bus=new e.Audio.Core.Bus2({amp:0}).connect(),n.connect(n.bus),n.replace=function(e,o,r){n.follow.input=e,-1===e[r].targets.indexOf(t)&&e[r].targets.push([t,t.Name])};var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),t.object.mod?t.object.mod(t.propertyName,n,"="):t.modObject.mod(t.modName,n,"="),n.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete o.object.track,this.follow.remove())),t.object.mod?t.object.removeMod(t.propertyName):t.modObject.removeMod(t.modName),delete t.object[t.Name].mapping},n},audioOut:function(o,n){if("undefined"!=typeof o.object[o.Name].mapping)return console.log("REPLACING MAPPING"),r.replace(n.object,n.propertyName,n.Name),r;var r=o.object[o.Name].mapping=e.Audio.Core.Binops.Map(null,o.min,o.max,0,1,0);"undefined"!=typeof n.object.track?(r.follow=n.object.track,r.follow.count++):(r.follow=new e.Audio.Core.Follow({input:n.object}),r.follow.count=1),n.object.track=r.follow;var i=r.follow.bufferSize;return Object.defineProperty(o.object[o.Name],"env",{configurable:!0,get:function(){return i},set:function(t){i=e.Clock.time(t),r.follow.bufferSize=i}}),r.input=r.follow,r.bus=new e.Audio.Core.Bus2({amp:0}).connect(),r.connect(r.bus),r.replace=function(t,i,a){if(t[a].timescale===n.timescale){var u=r.follow.input[n.Name].targets.indexOf(o);u>=-1&&r.follow.input[n.Name].targets.splice(u,1),r.follow.input=t,-1===t[a].targets.indexOf(o)&&t[a].targets.push([o,o.Name])}else r.bus.disconnect(),r.follow.remove(),e.createMappingObject(o,t)},o.object.mod?o.object.mod(o.propertyName,r,"="):o.modObject?o.modObject.mod(o.modName,r,"="):!function(){var e=r;o.object.update=function(){o.object[o.propertyName](e.getValue())}}(),r.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete n.object.track,this.follow.remove())),o.object.mod?o.object.removeMod(o.propertyName):o.modObject?o.modObject.removeMod(o.modName):console.log("removing update "),o.object.mappings.splice(o.object.mappings.indexOf(r),1),n.object.mappings.splice(n.object.mappings.indexOf(r),1);var e=o.object[o.Name].targets,i=e.indexOf(t);-1!==i&&e.splice(i,1),delete o.object[o.Name].mapping},r}},notation:{graphics:function(t,o){var n,r=e.Audio.Core.Binops.Map(o.object[o.propertyName],t.min,t.max,o.min,o.max,t.output,o.wrap),i=r.getValue.bind(r);return r.getValue=function(){return r.callback(o.object[o.propertyName],t.min,t.max,o.min,o.max,t.output,o.wrap),i()},n=t.object[t.Name].mapping=r,t.object.mod?t.object.mod(t.propertyName,n,"="):t.modObject.mod(t.modName,n,"="),n.remove=function(){t.object.mod?t.object.removeMod(t.propertyName):t.modObject.removeMod(t.modName),t.object[t.propertyName]=t.object[t.Name].mapping.getValue(),delete t.object[t.Name].mapping},n.replace=function(e){n.input=e},n},"interface":function(t,o){var n,r=e.Audio.Core.Binops.Map(o.object[o.propertyName],t.min,t.max,o.min,o.max,t.output,o.wrap);"undefined"==typeof o.object.functions&&(o.object.functions={},o.object.onvaluechange=function(){for(var e in o.object.functions)o.object.functions[e]()}),n=t.object[t.Name].mapping=r,t.mapping.from=o;var i=t.propertyName+" <- "+o.object.propertyName+"."+o.Name;if(o.object.functions[i]=function(){var e=n.callback(o.object[o.propertyName],t.min,t.max,o.min,o.max,t.output,o.wrap);t.object[t.Name].oldSetter.call(t.object[t.Name],e)},n.replace=function(){},n.remove=function(){console.log("mapping removed"),delete o.object.functions[i]},o.object.setValue&&o.object.setValue(t.object[t.propertyName]),"undefined"!=typeof o.object.label){for(var a="",u=0;u<o.targets.length;u++){var c=o.targets[u];a+=c[0].object.propertyName+"."+c[1],u!==o.targets.length-1&&(a+=" & ")}o.object.label=a}return n},audio:function(t,o){var n;n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(null,t.min,t.max,o.min,o.max,t.output,o.wrap),"undefined"!=typeof o.object.track&&o.object.track.input===o.object.properties[o.propertyName]?(n.follow=o.object.track,n.follow.count++):(n.follow=new e.Audio.Core.Follow({input:o.object.properties[o.propertyName],useAbsoluteValue:!1}),n.follow.count=1),o.object.track=t.object[t.Name].mapping.follow,n.input=n.follow,n.bus=new e.Audio.Core.Bus2({amp:0}).connect(),n.connect(n.bus),n.replace=function(e,o,r){n.follow.input=e,-1===e[r].targets.indexOf(t)&&e[r].targets.push([t,t.Name])};var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),n.update=function(){t.object[t.propertyName](n.getValue())},n.text=t.object,e.Environment.Notation.add(n),n.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete o.object.track,this.follow.remove())),e.Environment.Notation.remove(n),delete t.object[t.Name].mapping},n},audioOut:function(t,o){if("undefined"!=typeof t.object[t.Name].mapping)return n.replace(o.object,o.propertyName,o.Name),n;var n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(null,t.min,t.max,0,1,0);console.log("MAPPING",o),"undefined"!=typeof o.object.track&&o.object.track.input===o.object.properties[o.propertyName]?(n.follow=o.object.track,n.follow.count++):(n.follow=new e.Audio.Core.Follow({input:o.object,useAbsoluteValue:!0}),n.follow.count=1),o.object.track=n.follow;var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{configurable:!0,get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),n.input=n.follow,n.bus=new e.Audio.Core.Bus2({amp:0}).connect(),n.connect(n.bus),n.replace=function(r,i,a){if(r[a].timescale===o.timescale){var u=n.follow.input[o.Name].targets.indexOf(t);u>=-1&&n.follow.input[o.Name].targets.splice(u,1),n.follow.input=r,-1===r[a].targets.indexOf(t)&&r[a].targets.push([t,t.Name])}else n.bus.disconnect(),n.follow.remove(),e.createMappingObject(t,r)},n.update=function(){t.object[t.propertyName](n.getValue())},n.text=t.object,e.Environment.Notation.add(n),n.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete o.object.track,this.follow.remove())),e.Environment.Notation.remove(n),delete t.object[t.Name].mapping},n}}};return t},t.exports.outputCurves={LINEAR:0,LOGARITHMIC:1}},{}],4:[function(e,t){t.exports=function(e){"use strict";var t=[],o=!1,n=(e.dollar,e.Audio?e.Audio.Core:null,e.Clock,Math.random,{seq:function(){var e=arguments[0],t=typeof e,o=null;return"object"===t&&Array.isArray(e)&&(t="array"),o},random:function(){for(var e={},t=null,o=0;o<arguments.length;o+=2)e[""+arguments[o]]={repeat:arguments[o+1],count:0};return this.pick=function(){var o,r,i=0;return this[t]&&(r=this[t]),null!==t&&e[r].count++<=e[r].repeat?(o=t,e[r].count>=e[r].repeat&&(e[r].count=0,t=null)):(o=n.rndi(0,this.length-1),i=this[o],"undefined"!=typeof e[""+i]?(e[""+i].count=1,t=o):t=null),o},this},random2:function(){for(var e={},t=null,o=this,r=0;r<arguments.length;r+=2)e[""+arguments[r]]={repeat:arguments[r+1],count:0};return this.pick=function(){var r,i,a=0;return o[t]&&(i=o[t]),null!==t&&e[i].count++<=e[i].repeat?(r=t,e[i].count>=e[i].repeat&&(e[i].count=0,t=null)):(r=n.rndi(0,o.length-1),a=o[r],"undefined"!=typeof e[""+a]?(e[""+a].count=1,t=r):t=null),o[r]},this.pick},choose:function(e){var t=null;if(isNaN(e)&&(e=1),1!==e){for(var o=[],r=0;e>r;r++)o[r]=this[n.rndi(0,this.length-1)];t=o}else t=this[n.rndi(0,this.length-1)];return t},future:function(t,o){var n=0,r=e.Audio.Seqs.Seq(function(){1===n&&(t(),r.stop(),r.disconnect()),n++},e.Audio.Clock.time(o));return function(){r.stop(),r.disconnect()}},shuffle:function(e){for(var t,o,n=e.length;n;t=parseInt(Math.random()*n),o=e[--n],e[n]=e[t],e[t]=o);},solo:function(e){var r=Array.prototype.slice.call(arguments,0);if(e){o&&n.solo();for(var i=0;i<r.length;i++){var a=r[i];a.fx.length>0&&(r[i]=a.fx[a.fx.length-1])}for(var u=0;u<Master.inputs.length;u++){var c=r.indexOf(Master.inputs[u].value),p=Master.inputs[u].value,l=p.name;-1===c&&"polyseq"!==l&&"Seq"!==l&&(Master.inputs[u]._amp=Master.inputs[u].amp,Master.inputs[u].amp=0,t.push(Master.inputs[u]))}o=!0}else{for(var u=0;u<t.length;u++)t[u].amp=t[u]._amp;t.length=0,o=!1}},fill:function(e,t){isNaN(e)&&(e=16),"function"!=typeof t&&(t=Rndf()),t=t.bind(this);for(var o=0;e>o;o++)this[o]=t();return this},merge:function(){for(var e=[],t=0;t<this.length;t++){var o=this[t];if(Array.isArray(o))for(var n=0;n<o.length;n++)e.push(o[n]);else e.push(o)}return e},weight:function(){var e=Array.prototype.slice.call(arguments,0);return this.pick=function(){for(var t=this[0],o=0,r=n.rndf(),i=0;i<e.length;i++)if(o+=e[i],o>r){t=i;break}return t},this},gibberArray:function(){},rndf:function(e,t,o,r){if(r="undefined"==typeof r?!0:r,"undefined"==typeof o&&"object"!=typeof e){1==arguments.length?(t=arguments[0],e=0):2==arguments.length?(e=arguments[0],t=arguments[1]):(e=0,t=1);var i=t-e,a=Math.random(),u=i*a;return e+u}var c=[],p=[];"undefined"==typeof o&&(o=t||e.length);for(var l=0;o>l;l++){var s;if("object"==typeof arguments[0])s=arguments[0][rndi(0,arguments[0].length-1)];else if(r)s=n.rndf(e,t);else{for(s=n.rndf(e,t);p.indexOf(s)>-1;)s=n.rndf(e,t);p.push(s)}c.push(s)}return c},Rndf:function(){{var e,t,o,r;Math.random}return 0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],o=arguments[2]):(e=arguments[0],t=arguments[1],o=arguments[2],r=arguments[3]),function(){var i,a,u;return a="function"==typeof e?e():e,u="function"==typeof t?t():t,i="undefined"==typeof o?n.rndf(a,u):n.rndf(a,u,o,r)}},rndi:function(e,t,o,r){var i;if(0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):(e=arguments[0],t=arguments[1],o=arguments[2],r=arguments[3]),i=t-e,o>i&&(r=!0),"undefined"==typeof o)return i=t-e,Math.round(e+Math.random()*i);for(var a=[],u=[],c=0;o>c;c++){var p;if(r)p=n.rndi(e,t);else{for(p=n.rndi(e,t);u.indexOf(p)>-1;)p=n.rndi(e,t);u.push(p)}a.push(p)}return a},Rndi:function(){{var e,t,o,r,i;Math.random,Math.round}return 0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],o=arguments[2]):(e=arguments[0],t=arguments[1],o=arguments[2],r=arguments[3]),i=t-e,"number"==typeof o&&o>i&&(r=!0),function(){var i,a,u;return a="function"==typeof e?e():e,u="function"==typeof t?t():t,i="undefined"==typeof o?n.rndi(a,u):n.rndi(a,u,o,r)}},"export":function(e){e.rndi=n.rndi,e.rndf=n.rndf,e.Rndi=n.Rndi,e.Rndf=n.Rndf,e.future=n.future,e.solo=n.solo},init:function(){Array.prototype.random=Array.prototype.rnd=n.random,Array.prototype.weight=n.weight,Array.prototype.fill=n.fill,Array.prototype.choose=n.choose,Array.prototype.merge=n.merge}});return n}},{}],5:[function(e,t){!function(){t.exports={test:"testing 1 2 3"}}()},{}],6:[function(e,t){!function(){var o=e("gibber.core.lib");t.exports=e("./communication.js")(o)}()},{"./communication.js":5,"gibber.core.lib":2}]},{},[6])(6)});